<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    {% load static %}
    <!-- Local Css/Js -->
    <link
      rel="stylesheet"
      type="text/css"
      href="{% static 'css/reviews.css' %}"
    />
    <script defer src="{% static 'javascript/reviews.js' %}"></script>
    <!-- CDN -->
    <!-- Bootstrap latest -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"
      crossorigin="anonymous"
    />
    <!-- Bootstrap Table -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"
    />
  </head>
  <body>
    <main class="contact">
      <nav class="navbar navbar-light bg-dark">
        <div class="container-fluid">
          <div class="navbar-header">
            <a href="{% url 'djangoapp:index' %}" class="anchor">Home</a>
            <a href="{% url 'djangoapp:about' %}" class="anchor">About Us</a>
            <a href="{% url 'djangoapp:dealerships' %}" class="anchor"
              >Dearlers</a
            >
            <a href="{% url 'djangoapp:reviews' %}" class="anchor">Reviews</a>
            <a href="{% url 'djangoapp:contact' %}" class="anchor">Contact</a>
          </div>
          <div class="r-anchor">
            <ul class="nav navbar-nav navbar-right">
              {% if user.is_authenticated %}
              <li>
                <a class="btn btn-link" href="#"
                  >{{ user.first_name }}({{ user.username }})</a
                >
                <a class="btn btn-link" href="{% url 'djangoapp:logout' %}"
                  >Logout</a
                >
              </li>
              {% else %}
              <li>
                <a
                  class="btn btn-link text-decoration-none"
                  href="{% url 'djangoapp:login' %}"
                  >Login
                </a>
                <a
                  class="btn btn-link text-decoration-none"
                  href="{% url 'djangoapp:registration' %}"
                  >Sign Up
                </a>
              </li>
              {% endif %}
            </ul>
          </div>
        </div>
      </nav>
      <div class="seperator">
        <div class="devider-sep"></div>
      </div>

      <header>
        <h2 class="h2">Clients feedbacks/reviews</h2>
      </header>

      <!--Add review form here -->
      <!-- Adding sentimental analysis for authenticated users to view dealerships  -->
      <section class="sentiment" id="sentiment">
        <div class="inner_sentiment">
          <div class="columns_own">
            {% for test in data %}
            <!--indent  -->
            {% for anal_test in analyse.keywords %}
            <!-- Here is sentiment analysis to define -->
            {% if anal_test.sentiment.label == 'positive' %}
            <div class="d-inline-flex p-2 mx-auto">
              <div class="card" style="width: 18rem">
                <div class="card-body bg-primary rounded-4 mb-4">
                  <img
                    class="card-img-left mb-3"
                    src="{{MEDIA_URL}}/emoji/positive.png"
                    width="40px"
                    height="20px"
                  />
                  &nbsp; &nbsp;<span>{{ anal_test.sentiment.label }}</span>
                  <hr />

                  <div class="card-titlemb-3">
                    {{ test.doc.car_make}} &nbsp; {{test.doc.car_model}}

                    <div class="card-subtitle mb-3">
                      {{ test.doc.car_year }}
                      <div class="card-text">{{ test.doc.review }}</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            {% elif anal_test.sentiment.label == 'neutral' %}
            <div
              class="d-inline-flex flex-row justify-content-center align-items-center p-2 mx-auto"
            >
              <div class="card rounded-4" style="width: 18rem">
                <div class="card-body text-dark mb-4">
                  <img
                    class="card-img-left mb-0"
                    src="{{MEDIA_URL}}/emoji/neutral.png"
                    width="40px"
                    height="20px"
                  />
                  &nbsp; &nbsp;<span>{{ anal_test.sentiment.label }}</span>
                  <hr />
                  <div class="card-title">
                    <span class="mb-3">
                      {{test.doc.car_make}} &nbsp; {{test.doc.car_model}}</span
                    >
                    <div class="card-subtitle mb-3">
                      {{ test.doc.car_year }}
                      <div class="card-text">{{ test.doc.review }}</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            {% else %}
            <div class="d-inline-flex p-2 mx-auto">
              <div class="card" style="width: 18rem">
                <img
                  class="card-img-left"
                  src="{{MEDIA_URL}}/emoji/negative.png"
                  width="40px"
                  height="20px"
                />
                &nbsp; &nbsp;<span>{{ anal_test.sentiment.label }}</span> <br />
                <div class="card-body bg-dangerous text-warning rounded-4 mb-4">
                  <div class="card-title">
                    <span class="mb-3">
                      {{test.doc.car_make}} &nbsp; {{test.doc.car_model}}</span
                    >
                    <div class="card-subtitle mb-3">
                      {{ test.doc.car_year }}
                      <div class="card-text">{{ test.doc.review }}</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            {% endif %}
            <!-- close for loop-->
            {% endfor %}
            <!-- close for loop- -->
            {% endfor %}
          </div>
        </div>
      </section>

      <!-- Need to create purchase to buy a car and not a list of cars in the json file -->
      <section>
        <textarea
          class="form-control w-3"
          id="content"
          name="content"
          rows="2"
          cols="3"
          required
        ></textarea>
        <input
          class="form-check-input w-3"
          type="checkbox"
          name="purchasecheck"
          id="purchasecheck"
        />
        <select name="car" id="car" class="form-select" required>
          { for car in reviews %}
          <option selected value="{{car.id}}">
            {{car.name}}-{{car.make.name}}-{{ car.year|date:"Y" }}
          </option>
          { endfor %}
        </select>
        <!-- Create calendar jquery -->
        <script type="text/javascript">
          $('.date-own').datepicker({
            format: 'mm/dd/yyyy',
          });
        </script>
      </section>

      <div class="seperator">
        <div class="devider-sep"></div>
      </div>

      <section class="feedback">
        <h3 class="h3">
          If you have a minute while you're here, AKA dealers love to hear your
          feedback/review
        </h3>
        <!-- Add review  -->
        <div class="row mt-5">
          <div class="mx-auto col-10 p-20">
            <form method="POST" class="ml-5 p-2">
              {% csrf_token %}
              <div class="mb-2 row">
                Name:
                <div class="col-sm-10" style="margin-left: 30px">
                  <input
                    type="text"
                    name="name"
                    placeholder="Enter your name e.g. Nicergrer"
                    id="revs"
                    class="rounded-2"
                    size="20"
                    minlength="4"
                    maxlength="20"
                    required
                  />
                </div>
              </div>
              <div class="mb-2 row">
                Car Type:
                <div class="col-sm-10" style="margin-left: 10px">
                  <input
                    type="text"
                    name="ctype"
                    placeholder="Enter car type e.g. Ford"
                    id="ctype"
                    class="rounded-2"
                  />
                </div>
              </div>
              <div class="mb-2 row">
                Car Model:
                <div class="col-sm-10">
                  <input
                    type="text"
                    name="cmodel"
                    placeholder="Enter car model e.g. A3"
                    id="cmodel"
                    class="rounded-2"
                  />
                </div>
              </div>
              <div class="mb-2 row">
                Car Year:
                <div class="col-sm-10" style="margin-left: 15px">
                  <input
                    type="number"
                    name="year"
                    placeholder="Enter year e.g. 2100 "
                    id="year"
                    class="rounded-2"
                  />
                </div>
              </div>

              <div class="mb-2 row">
                Have you purchased?:
                <div class="col-sm-10">
                  <input
                    class="form-check-input ml-2 p-1"
                    name="purchase"
                    type="checkbox"
                    id="purchase"
                    autocomplete
                  />
                </div>
              </div>
              <div class="mb-2 row">
                Purchased date:
                <div>
                  <input
                    class="mx-auto px-auto"
                    type="date"
                    name="client_purchase"
                    id="date-own"
                    min="01-01-1900"
                    max="31-12-2023"
                  />
                </div>
              </div>

              <div class="form-group">
                <label class="" for="txtarea">Your Message: </label>
                <textarea
                  class="form-control w-50 rounded-4"
                  id="txtarea"
                  rows="5"
                  name="review"
                  required
                ></textarea>
              </div>
              <button class="btn btn-primary rounded-3 mt-2" type="submit">
                Send
              </button>
            </form>

            <script type="text/javascript">
              $('#date-own').datepicker({
                format: 'mm-dd-yyyy',
              });
            </script>
          </div>
        </div>

        <button class="btn btn-secondary m-5 py-2 px-4 rounded-4">
          <a
            href="{% url 'djangoapp:dealerships' %} "
            class="text-warning text-decoration-none"
            >Back</a
          >
        </button>
        <!-- <div class="seperator">
        <div class="devider-sep"></div>
      </div> -->
      </section>
    </main>
    <!-- JS -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
      crossorigin="anonymous"
    ></script>
    <!-- JQuery -->
    <script
      src="https://code.jquery.com/jquery-3.6.4.slim.min.js"
      integrity="sha256-a2yjHM4jnF9f54xUQakjZGaqYs/V1CYvWpoqZzC2/Bw="
      crossorigin="anonymous"
    ></script>
    <!-- Ajax -->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js"
      integrity="sha512-pumBsjNRGGqkPzKHndZMaAG+bir374sORyzM3uulLV14lN5LyykqNk8eEeUlUkB3U0M4FApyaHraT65ihJhDpQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>

    <script src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.18.2/dist/extensions/filter-control/bootstrap-table-filter-control.min.js"></script>
  </body>
</html>
